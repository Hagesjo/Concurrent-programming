-module(server).
-export([loop/2, initial_state/1]).

-include_lib("./defs.hrl").



loop(St) -> 
    receive
	{connect, From, _Nick,} ->
		St2 = St#server_st.( users = [{From, _Nick} | St#server_st.users]),
		case lists:member({_, _Nick}, St#server_st.users) of
			true ->
				{nick_exist, St};
		end;
			
		case lists:member({From, _Nick}, St#server_st.users) of
			true ->
				{user_already_connected, St};
			false -> 
				{ok, St2}
		end;
	{disconnect, From, _Nick} ->
		St2 = St#server_st.(users = lists:delete({From, _Nick}, St#server_st.users))
		
	{join, From, Ref, _Channel} ->
		%%%%%TODO%%%%%
	{leave, From, Ref, _Channel} ->
		%%%%%TODO%%%%%
	{msg_from_GUI, From, Ref, _Channel, _Msg} ->
		%%%%%TODO%%%%%
	{nick, From, Ref, _Nick} ->
		%%%%%TODO%%%%%
initial_state(_Server) ->
    #server_st{}.
